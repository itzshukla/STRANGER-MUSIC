# -----------------------------------------------
# ğŸ”¸ StrangerMusic Project
# ğŸ”¹ Developed & Maintained by: Shashank Shukla (https://github.com/itzshukla)
# ğŸ“… Copyright Â© 2025 â€“ All Rights Reserved
#
# ğŸ“– License:
# This source code is open for educational and non-commercial use ONLY.
# You are required to retain this credit in all copies or substantial portions of this file.
# Commercial use, redistribution, or removal of this notice is strictly prohibited
# without prior written permission from the author.
#
# â¤ï¸ Made with dedication and love by ItzShukla
# -----------------------------------------------

import asyncio
from pyrogram import Client, filters
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup, Message
from SHUKLAMUSIC import app
from SHUKLAMUSIC.utils.database import add_served_chat, get_assistant, booster

OWNERS = "6919199044"


@app.on_message(filters.command("gadd") & filters.user(booster))
async def add_allbot(client, message):
    command_parts = message.text.split(" ")
    if len(command_parts) != 2:
        await message.reply(
            "**â ÉªÉ´á´ á´€ÊŸÉªá´… á´„á´á´á´á´€É´á´… Ò“á´Ê€á´á´€á´›. á´˜ÊŸá´‡á´€sá´‡ á´œsá´‡ ÊŸÉªá´‹á´‡ Â» `/gadd @Bot_username`**"
        )
        return

    bot_username = command_parts[1]
    try:
        userbot = await get_assistant(message.chat.id)
        bot = await app.get_users(bot_username)
        app_id = bot.id
        done = 0
        failed = 0
        lol = await message.reply("â **á´€á´…á´…ÉªÉ´É¢ É¢Éªá´ á´‡É´ Ê™á´á´› ÉªÉ´ á´€ÊŸÊŸ á´„Êœá´€á´›s!**")
        await userbot.send_message(bot_username, f"/start")
        async for dialog in userbot.get_dialogs():
            if dialog.chat.id == -1002100130095:
                continue
            try:

                await userbot.add_chat_members(dialog.chat.id, app_id)
                done += 1
                await lol.edit(
                    f"**â á´€á´…á´…ÉªÉ´É¢ {bot_username}**\n\n**â¥ á´€á´…á´…á´‡á´… ÉªÉ´ {done} á´„Êœá´€á´›s âœ”**\n**â¥ Ò“á´€ÉªÊŸá´‡á´… ÉªÉ´ {failed} á´„Êœá´€á´›s âœ˜**\n\n**â² á´€á´…á´…á´‡á´… Ê™ÊÂ»** @{userbot.username}"
                )
            except Exception as e:
                failed += 1
                await lol.edit(
                    f"**â á´€á´…á´…ÉªÉ´É¢ {bot_username}**\n\n**â¥ á´€á´…á´…á´‡á´… ÉªÉ´ {done} á´„Êœá´€á´›s âœ”**\n**â¥ Ò“á´€ÉªÊŸá´‡á´… ÉªÉ´ {failed} á´„Êœá´€á´›s âœ˜**\n\n**â² á´€á´…á´…ÉªÉ´É¢ Ê™ÊÂ»** @{userbot.username}"
                )
            await asyncio.sleep(3)  # Adjust sleep time based on rate limits

        await lol.edit(
            f"**â {bot_username} Ê™á´á´› á´€á´…á´…á´‡á´… sá´œá´„á´„á´‡ssÒ“á´œÊŸÊŸÊğŸ‰**\n\n**â¥ á´€á´…á´…á´‡á´… ÉªÉ´ {done} á´„Êœá´€á´›s âœ…**\n**â¥ Ò“á´€ÉªÊŸá´‡á´… ÉªÉ´ {failed} á´„Êœá´€á´›s âœ˜**\n\n**â² á´€á´…á´…á´‡á´… Ê™ÊÂ»** @{userbot.username}"
        )
    except Exception as e:
        await message.reply(f"Error: {str(e)}")